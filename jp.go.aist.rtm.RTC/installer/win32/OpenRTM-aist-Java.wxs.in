<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">   
  <?define ProductName = "{% Product.Name %}-{% Product.Version %} for Java"?>
  <Product Name="{% Product.Name %}-{% Product.Version %} for Java"
           Id="{% Product.Id %}"
           Language='$(var.language)'
           Codepage='$(var.codepage)'
           Version="{% Product.Version %}"
           Manufacturer="{% Product.Manufacturer %}"
	   UpgradeCode="{% Product.UpgradeCode %}">
    <Package Id="*" 
             Keywords="Installer"
             Description="{% Package.Description %}"
             InstallerVersion="300"
             Languages='$(var.language)'
             Compressed="yes"
             SummaryCodepage='$(var.codepage)' />

    <!-- Property -->
    <Property Id='USERPROFILEDIR' Value='%USERPROFILE%' />
    <Property Id="JDK15">
      <RegistrySearch Id="JDK15"
                      Root="HKLM"
                      Key="SOFTWARE\JavaSoft\Java Development Kit\1.5"
                      Name="JavaHome"
                      Type="raw" />
    </Property>
    <Property Id="JDK16">
      <RegistrySearch Id="JDK16"
                      Root="HKLM"
                      Key="SOFTWARE\JavaSoft\Java Development Kit\1.6"
                      Name="JavaHome"
                      Type="raw" />
    </Property>
    
    <!-- RTSE Property-->
<!--
    <Property Id="FILEEXISTS">
      <DirectorySearch Id="CheckFileDir" Path="C:\Program Files">
        <DirectorySearch Id="CheckFileDir2" Path ="OpenRTP">
          <DirectorySearch Id="CheckFileDir3" Path ="RTSystemEditor">
            <FileSearch Id="CheckFile" Name="RTSystemEditorRCP.exe" />
          </DirectorySearch>
        </DirectorySearch>
      </DirectorySearch>
    </Property>
-->
<!--     <SetProperty Id="FILEEXISTSDIR" After="AppSearch" Value="[FILEEXISTS]">
    </SetProperty>-->

    <!-- Upgrade -->
    <Upgrade Id="{% Product.UpgradeCode %}">
      <UpgradeVersion OnlyDetect="yes"
                      Minimum="1.1.0.1"
                      Maximum="1.2.0"
                      Property="NEWERVERSIONDETECTED"
                      IncludeMinimum="no" /> 
      <UpgradeVersion OnlyDetect="no"
                      Minimum="1.1.0"
                      Maximum="1.1.0.1"
                      Property="OLDERVERSIONBEINGUPGRADED"
                      IncludeMaximum="no" /> 
      <UpgradeVersion OnlyDetect='no' Property='PREVIOUSFOUND'
                      Minimum='1.1.0' IncludeMinimum='yes'
                      Maximum='1.2.0' IncludeMaximum='no' />
    </Upgrade>
    <InstallExecuteSequence>
      <RemoveExistingProducts Before="InstallInitialize"/>
    </InstallExecuteSequence>
    <!-- Media -->
    <Media Id="1" Cabinet="OpenRTMjava.cab" EmbedCab="yes"/>
    
    <!-- Install for All -->
    <!-- <Property Id="ALLUSERS" Value="1" /> -->
    
    <!-- Check Conditions -->
    <Condition Message="[ProductName] requires JDK 1.5 or 1.6">
      <![CDATA[Installed OR (JDK15 <> "" OR JDK16 <> "")]]>
    </Condition>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <!-- Program Files Folder -->
      <Directory Id="ProgramFilesFolder" SourceName="PFILE">
        <Directory Id="INSTALLLOCATION"
               Name="{% Product.Name %}">
          <Directory Id="Version"
                 Name="{% Product.ShortVersion %}">

            <!-- RTM_JAVA_ROOT setting -->
            <Component Id="ENV1" Guid="C41EB819-D5E6-11DC-A98E-0090CC744077">
              <Condition>
                <![CDATA[ALLUSERS <> 1]]>
              </Condition>
              <Environment Id="envRTMJAVAROOTlocal" Name="RTM_JAVA_ROOT" Action="set" 
                           System="no" Part="last" Value="[Version]"/>
            </Component>
            <Component Id="ENV2" Guid="79E15E8C-E890-4fe7-A4A0-9EE6237DEE7D">
              <Condition>
                <![CDATA[ALLUSERS = 1 AND Privileged = 1]]>
              </Condition>
              <Environment Id="envRTMJAVAROOTsystem" Name="RTM_JAVA_ROOT" Action="set" 
                           System="yes" Part="last" Value="[Version]"/>
            </Component>

            <!-- bin -->
            <Directory Id="bin" Name="bin">
              <Component Id="RtmSourceExamplesBin" Guid="{% RtmSourceExamplesBin.GUID %}">
                <RemoveFolder Id='RtmSourceExamplesBin_f' On='uninstall'/>
                {% for file in RtmSourceExamplesBin.Files %}
                  <File Id="{% file.Id %}"
                       Name="{% file.Name %}" DiskId="1"
                       Source="{% file.Source %}">
                    {% if file.Name is start-orbd.vbs %}
                    <Shortcut Id="{% file.Id %}" Directory="ToolsMenuFolder"
                              Name="Start Naming Service"
                              Show="normal" WorkingDirectory="bin"/>
                    {% endif %}
                    {% if file.Name is rtcd_java.exe %}
                    <Shortcut Id="{% file.Id %}" Directory="ToolsMenuFolder"
                              Name="Start RTC daemon" Arguments=" -d"
                              Show="normal" WorkingDirectory="bin"/>
                    {% endif %}
                    {% if file.Name is rtcd_java.conf %}
                    <Shortcut Id="{% file.Id %}" Directory="ToolsMenuFolder"
			                        Name="rtc.conf for RTC deamon"
                              Show="normal" WorkingDirectory="bin"/>
                    {% endif %}

                  </File>
                {% endfor %}
              </Component>
            </Directory>

            <!-- jar -->
            <Directory Id="RTMjar" Name="jar">
              <Component Id="RtmSourceJar" Guid="{% RtmSourceJar.GUID %}">
                <RemoveFolder Id='RtmSourceJar_f' On='uninstall' />
                {% for file in RtmSourceJar.Files %}
                <File Id="{% file.Id %}"
                      Name="{% file.Name %}" DiskId="1"
                      Source="{% file.Source %}">
                </File>
                {% endfor %}
                <File Id="RtmSourceJarLicense"
                      Name="License.txt" DiskId="1"
                      Source="License.txt">
                </File>
              </Component>
            </Directory>

            <!-- idl -->
            <Directory Id="RTM_JAVA" Name="rtm_java">
              <Directory Id="RTMidl" Name="idl">
                <Component Id="RtmSourceRtm_javaIdl" Guid="{% RtmSourceRtm_javaIdl.GUID %}">
                  <RemoveFolder Id='RtmIdl_f' On='uninstall' />
                  {% for file in RtmSourceRtm_javaIdl.Files %}
                  <File Id="{% file.Id %}"
                      Name="{% file.Name %}" DiskId="1"
                      Source="{% file.Source %}">
                  </File>
                  {% endfor %}
                </Component>
                <Directory Id="RTMidl_device_interfaces" Name="device_interfaces">
                  <Component Id="RtmSourceRtm_javaIdlDevice_interfaces" Guid="{% RtmSourceRtm_javaIdlDevice_interfaces.GUID %}">
                    <RemoveFolder Id='RtmIdlDevice_interfaces_f' On='uninstall' />
                    {% for file in RtmSourceRtm_javaIdlDevice_interfaces.Files %}
                    <File Id="{% file.Id %}"
                      Name="{% file.Name %}" DiskId="1"
                      Source="{% file.Source %}">
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>
              </Directory>
            </Directory>

            <!-- doc -->
            <Directory Id="docs" Name="doc">

              <!-- Java -->
              <Directory Id="Javadoc" Name="Java">

                <!-- classref_jp -->
                <Directory Id="classref_jp" Name="classref_jp">
                  <Component Id="RtmSourceJavadoc" 
                             Guid="{% RtmSourceJavadoc.GUID %}">
                    <RemoveFolder Id='RtmSourceJavadoc_f' On='uninstall' />
                    {% for file in RtmSourceJavadoc.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is index.html %}
                      <Shortcut Id="{% file.Id %}" Directory="DocMenuFolder"
                                Name="Japanese Class reference"
                                Show="normal" WorkingDirectory="classref_jp"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>

                  <!-- _SDOPackage -->
                  <Directory Id="doc_jp__SDOPackage" Name="_SDOPackage">
                    <Component Id="RtmSourceJavadoc_sdopackage" 
                               Guid="{% RtmSourceJavadoc_sdopackage.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadoc_sdopackage_f' On='uninstall' />
                      {% for file in RtmSourceJavadoc_sdopackage.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- _SDOPackage/class-use -->
                    <Directory Id="doc_jp__SDOPackage_classuse" Name="class-use">
                      <Component Id="RtmSourceJavadoc_sdopackageClassuse" 
                                 Guid="{% RtmSourceJavadoc_sdopackageClassuse.GUID %}">
                        <RemoveFolder Id='RtmSourceJavadoc_sdopackageClassuse_f' On='uninstall' />
                        {% for file in RtmSourceJavadoc_sdopackageClassuse.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>

                  <!-- index-files -->
                  <Directory Id="doc_jp_indexfiles" Name="index-files">
                    <Component Id="RtmSourceJavadocIndexfiles" 
                               Guid="{% RtmSourceJavadocIndexfiles.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocIndexfiles_f' On='uninstall' />
                      {% for file in RtmSourceJavadocIndexfiles.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>
                  </Directory>

                  <!-- jp -->
                  <Directory Id="doc_jp_jp" Name="jp">
                    <!-- go -->
                    <Directory Id="doc_jp_jp_go" Name="go">
                      <!-- aist -->
                      <Directory Id="doc_jp_jp_go_aist" Name="aist">
                        <!-- rtm -->
                        <Directory Id="doc_jp_jp_go_aist_rtm" Name="rtm">
                          <Component Id="RtmSourceJavadocJpGoAistRtm" 
                                     Guid="{% RtmSourceJavadocJpGoAistRtm.GUID %}">
                            <RemoveFolder Id='RtmSourceJavadocJpGoAistRtm_f' On='uninstall' />
                            {% for file in RtmSourceJavadocJpGoAistRtm.Files %}
                            <File Id="{% file.Id %}"
                                  Name="{% file.Name %}" DiskId="1"
                                  Source="{% file.Source %}">
                            </File>
                            {% endfor %}
                          </Component>

                          <!-- rtm/class-use -->
                          <Directory Id="doc_jp_jp_go_aist_rtm_classuse" Name="class-use">
                            <Component Id="RtmSourceJavadocJpGoAistRtmClassuse" 
                                       Guid="{% RtmSourceJavadocJpGoAistRtmClassuse.GUID %}">
                              <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmClassuse_f' On='uninstall' />
                              {% for file in RtmSourceJavadocJpGoAistRtmClassuse.Files %}
                              <File Id="{% file.Id %}"
                                    Name="{% file.Name %}" DiskId="1"
                                    Source="{% file.Source %}">
                              </File>
                              {% endfor %}
                            </Component>
                          </Directory>

                          <!-- rtm/RTC -->
                          <Directory Id="doc_jp_jp_go_aist_rtm_RTC" Name="RTC">
                            <Component Id="RtmSourceJavadocJpGoAistRtmRtc" 
                                       Guid="{% RtmSourceJavadocJpGoAistRtmRtc.GUID %}">
                              <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtc_f' On='uninstall' />
                              {% for file in RtmSourceJavadocJpGoAistRtmRtc.Files %}
                              <File Id="{% file.Id %}"
                                    Name="{% file.Name %}" DiskId="1"
                                    Source="{% file.Source %}">
                              </File>
                              {% endfor %}
                            </Component>

                            <!-- rtm/RTC/buffer -->
                            <Directory Id="doc_jp_jp_go_aist_rtm_RTC_buffer" Name="buffer">
                              <Component Id="RtmSourceJavadocJpGoAistRtmRtcBuffer" 
                                         Guid="{% RtmSourceJavadocJpGoAistRtmRtcBuffer.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcBuffer_f' On='uninstall' />
                                {% for file in RtmSourceJavadocJpGoAistRtmRtcBuffer.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/buffer/class-use -->
                              <Directory Id="doc_jp_jp_go_aist_rtm_RTC_buffer_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocJpGoAistRtmRtcBufferClassuse" 
                                           Guid="{% RtmSourceJavadocJpGoAistRtmRtcBufferClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcBufferClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocJpGoAistRtmRtcBufferClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/class-use -->
                            <Directory Id="doc_jp_jp_go_aist_rtm_RTC_classuse" Name="class-use">
                              <Component Id="RtmSourceJavadocJpGoAistRtmRtcClassuse" 
                                         Guid="{% RtmSourceJavadocJpGoAistRtmRtcClassuse.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcClassuse_f' On='uninstall' />
                                {% for file in RtmSourceJavadocJpGoAistRtmRtcClassuse.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>
                            </Directory>

                            <!-- rtm/RTC/executionContext -->
                            <Directory Id="doc_jp_jp_go_aist_rtm_RTC_executionContext" Name="executionContext">
                              <Component Id="RtmSourceJavadocJpGoAistRtmRtcExecutioncontext" 
                                         Guid="{% RtmSourceJavadocJpGoAistRtmRtcExecutioncontext.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcExecutioncontext_f' On='uninstall' />
                                {% for file in RtmSourceJavadocJpGoAistRtmRtcExecutioncontext.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/executionContext/class-use -->
                              <Directory Id="doc_jp_jp_go_aist_rtm_RTC_executionContext_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocJpGoAistRtmRtcExecutioncontextClassuse" 
                                           Guid="{% RtmSourceJavadocJpGoAistRtmRtcExecutioncontextClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcExecutioncontextClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocJpGoAistRtmRtcExecutioncontextClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/log -->
                            <Directory Id="doc_jp_jp_go_aist_rtm_RTC_log" Name="log">
                              <Component Id="RtmSourceJavadocJpGoAistRtmRtcLog" 
                                         Guid="{% RtmSourceJavadocJpGoAistRtmRtcLog.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcLog_f' On='uninstall' />
                                {% for file in RtmSourceJavadocJpGoAistRtmRtcLog.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/log/class-use -->
                              <Directory Id="doc_jp_jp_go_aist_rtm_RTC_log_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocJpGoAistRtmRtcLogClassuse" 
                                           Guid="{% RtmSourceJavadocJpGoAistRtmRtcLogClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcLogClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocJpGoAistRtmRtcLogClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/port -->
                            <Directory Id="doc_jp_jp_go_aist_rtm_RTC_port" Name="port">
                              <Component Id="RtmSourceJavadocJpGoAistRtmRtcPort" 
                                         Guid="{% RtmSourceJavadocJpGoAistRtmRtcPort.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcPort_f' On='uninstall' />
                                {% for file in RtmSourceJavadocJpGoAistRtmRtcPort.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/port/class-use -->
                              <Directory Id="doc_jp_jp_go_aist_rtm_RTC_port_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocJpGoAistRtmRtcPortClassuse" 
                                           Guid="{% RtmSourceJavadocJpGoAistRtmRtcPortClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcPortClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocJpGoAistRtmRtcPortClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>

                              <!-- rtm/RTC/port/publisher -->
                              <Directory Id="doc_jp_jp_go_aist_rtm_RTC_port_publisher" Name="publisher">
                                <Component Id="RtmSourceJavadocJpGoAistRtmRtcPortPublisher" 
                                           Guid="{% RtmSourceJavadocJpGoAistRtmRtcPortPublisher.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcPortPublisher_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocJpGoAistRtmRtcPortPublisher.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>

                                <!-- rtm/RTC/port/publisher/class-use -->
                                <Directory Id="doc_jp_jp_go_aist_rtm_RTC_port_publisher_classuse" Name="class-use">
                                  <Component Id="RtmSourceJavadocJpGoAistRtmRtcPortPublisherClassuse" 
                                             Guid="{% RtmSourceJavadocJpGoAistRtmRtcPortPublisherClassuse.GUID %}">
                                    <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcPortPublisherClassuse_f' On='uninstall' />
                                    {% for file in RtmSourceJavadocJpGoAistRtmRtcPortPublisherClassuse.Files %}
                                    <File Id="{% file.Id %}"
                                          Name="{% file.Name %}" DiskId="1"
                                          Source="{% file.Source %}">
                                    </File>
                                    {% endfor %}
                                  </Component>
                                </Directory>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/SDOPackage -->
                            <Directory Id="doc_jp_jp_go_aist_rtm_RTC_SDOPackage" Name="SDOPackage">
                              <Component Id="RtmSourceJavadocJpGoAistRtmRtcSdopackage" 
                                         Guid="{% RtmSourceJavadocJpGoAistRtmRtcSdopackage.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcSdopackage_f' On='uninstall' />
                                {% for file in RtmSourceJavadocJpGoAistRtmRtcSdopackage.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/SDOPackage/class-use -->
                              <Directory Id="doc_jp_jp_go_aist_rtm_RTC_SDOPackage_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocJpGoAistRtmRtcSdopackageClassuse" 
                                           Guid="{% RtmSourceJavadocJpGoAistRtmRtcSdopackageClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcSdopackageClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocJpGoAistRtmRtcSdopackageClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/util -->
                            <Directory Id="doc_jp_jp_go_aist_rtm_RTC_util" Name="util">
                              <Component Id="RtmSourceJavadocJpGoAistRtmRtcUtil" 
                                         Guid="{% RtmSourceJavadocJpGoAistRtmRtcUtil.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcUtil_f' On='uninstall' />
                                {% for file in RtmSourceJavadocJpGoAistRtmRtcUtil.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/util/class-use -->
                              <Directory Id="doc_jp_jp_go_aist_rtm_RTC_util_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocJpGoAistRtmRtcUtilClassuse" 
                                           Guid="{% RtmSourceJavadocJpGoAistRtmRtcUtilClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocJpGoAistRtmRtcUtilClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocJpGoAistRtmRtcUtilClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>
                          </Directory>
                        </Directory>
                      </Directory>
                    </Directory>
                  </Directory>

                  <!-- OpenRTM -->
                  <Directory Id="doc_jp_OpenRTM" Name="OpenRTM">
                    <Component Id="RtmSourceJavadocOpenrtm" 
                               Guid="{% RtmSourceJavadocOpenrtm.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocOpenrtm_f' On='uninstall' />
                      {% for file in RtmSourceJavadocOpenrtm.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- OpenRTM/class-use -->
                    <Directory Id="doc_jp_OpenRTM_classuse" Name="class-use">
                      <Component Id="RtmSourceJavadocOpenrtmClassuse" 
                                 Guid="{% RtmSourceJavadocOpenrtmClassuse.GUID %}">
                        <RemoveFolder Id='RtmSourceJavadocOpenrtmClassuse_f' On='uninstall' />
                        {% for file in RtmSourceJavadocOpenrtmClassuse.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>

                  <!-- resources -->
                  <Directory Id="doc_jp_resources" Name="resources">
                    <Component Id="RtmSourceJavadocResources" 
                               Guid="{% RtmSourceJavadocResources.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocResources_f' On='uninstall' />
                      {% for file in RtmSourceJavadocResources.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>
                  </Directory>

                  <!-- RTC -->
                  <Directory Id="doc_jp_RTC" Name="RTC">
                    <Component Id="RtmSourceJavadocRtc" 
                               Guid="{% RtmSourceJavadocRtc.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocRtc_f' On='uninstall' />
                      {% for file in RtmSourceJavadocRtc.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- RTC/class-use -->
                    <Directory Id="doc_jp_RTC_classuse" Name="class-use">
                      <Component Id="RtmSourceJavadocRtcClassuse" 
                                 Guid="{% RtmSourceJavadocRtcClassuse.GUID %}">
                        <RemoveFolder Id='RtmSourceJavadocRtcClassuse_f' On='uninstall' />
                        {% for file in RtmSourceJavadocRtcClassuse.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>

                  <!-- RTM -->
                  <Directory Id="doc_jp_RTM" Name="RTM">
                    <Component Id="RtmSourceJavadocRtm" 
                               Guid="{% RtmSourceJavadocRtm.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocRtm_f' On='uninstall' />
                      {% for file in RtmSourceJavadocRtm.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- RTM/class-use -->
                    <Directory Id="doc_jp_RTM_classuse" Name="class-use">
                      <Component Id="RtmSourceJavadocRtmClassuse" 
                                 Guid="{% RtmSourceJavadocRtmClassuse.GUID %}">
                        <RemoveFolder Id='RtmSourceJavadocRtmClassuse_f' On='uninstall' />
                        {% for file in RtmSourceJavadocRtmClassuse.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>

                </Directory>

                <!-- classref_en -->
                <Directory Id="classref_en" Name="classref_en">
                  <Component Id="RtmSourceJavadocen" 
                             Guid="{% RtmSourceJavadocen.GUID %}">
                    <RemoveFolder Id='RtmSourceJavadocen_f' On='uninstall' />
                    {% for file in RtmSourceJavadocen.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is index.html %}
                      <Shortcut Id="{% file.Id %}" Directory="DocMenuFolder"
                                Name="English Class reference"
                                Show="normal" WorkingDirectory="classref_en"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>

                  <!-- _SDOPackage -->
                  <Directory Id="doc_en__SDOPackage" Name="_SDOPackage">
                    <Component Id="RtmSourceJavadocen_sdopackage" 
                               Guid="{% RtmSourceJavadocen_sdopackage.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocen_sdopackage_f' On='uninstall' />
                      {% for file in RtmSourceJavadocen_sdopackage.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- _SDOPackage/class-use -->
                    <Directory Id="doc_en__SDOPackage_classuse" Name="class-use">
                      <Component Id="RtmSourceJavadocen_sdopackageClassuse" 
                                 Guid="{% RtmSourceJavadocen_sdopackageClassuse.GUID %}">
                        <RemoveFolder Id='RtmSourceJavadocen_sdopackageClassuse_f' On='uninstall' />
                        {% for file in RtmSourceJavadocen_sdopackageClassuse.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>

                  <!-- index-files -->
                  <Directory Id="doc_en_indexfiles" Name="index-files">
                    <Component Id="RtmSourceJavadocenIndexfiles" 
                               Guid="{% RtmSourceJavadocenIndexfiles.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocenIndexfiles_f' On='uninstall' />
                      {% for file in RtmSourceJavadocenIndexfiles.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>
                  </Directory>

                  <!-- jp -->
                  <Directory Id="doc_en_jp" Name="jp">
                    <!-- go -->
                    <Directory Id="doc_en_jp_go" Name="go">
                      <!-- aist -->
                      <Directory Id="doc_en_jp_go_aist" Name="aist">
                        <!-- rtm -->
                        <Directory Id="doc_en_jp_go_aist_rtm" Name="rtm">
                          <Component Id="RtmSourceJavadocenJpGoAistRtm" 
                                     Guid="{% RtmSourceJavadocenJpGoAistRtm.GUID %}">
                            <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtm_f' On='uninstall' />
                            {% for file in RtmSourceJavadocenJpGoAistRtm.Files %}
                            <File Id="{% file.Id %}"
                                  Name="{% file.Name %}" DiskId="1"
                                  Source="{% file.Source %}">
                            </File>
                            {% endfor %}
                          </Component>

                          <!-- rtm/class-use -->
                          <Directory Id="doc_en_jp_go_aist_rtm_classuse" Name="class-use">
                            <Component Id="RtmSourceJavadocenJpGoAistRtmClassuse" 
                                       Guid="{% RtmSourceJavadocenJpGoAistRtmClassuse.GUID %}">
                              <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmClassuse_f' On='uninstall' />
                              {% for file in RtmSourceJavadocenJpGoAistRtmClassuse.Files %}
                              <File Id="{% file.Id %}"
                                    Name="{% file.Name %}" DiskId="1"
                                    Source="{% file.Source %}">
                              </File>
                              {% endfor %}
                            </Component>
                          </Directory>

                          <!-- rtm/RTC -->
                          <Directory Id="doc_en_jp_go_aist_rtm_RTC" Name="RTC">
                            <Component Id="RtmSourceJavadocenJpGoAistRtmRtc" 
                                       Guid="{% RtmSourceJavadocenJpGoAistRtmRtc.GUID %}">
                              <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtc_f' On='uninstall' />
                              {% for file in RtmSourceJavadocenJpGoAistRtmRtc.Files %}
                              <File Id="{% file.Id %}"
                                    Name="{% file.Name %}" DiskId="1"
                                    Source="{% file.Source %}">
                              </File>
                              {% endfor %}
                            </Component>

                            <!-- rtm/RTC/buffer -->
                            <Directory Id="doc_en_jp_go_aist_rtm_RTC_buffer" Name="buffer">
                              <Component Id="RtmSourceJavadocenJpGoAistRtmRtcBuffer" 
                                         Guid="{% RtmSourceJavadocenJpGoAistRtmRtcBuffer.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcBuffer_f' On='uninstall' />
                                {% for file in RtmSourceJavadocenJpGoAistRtmRtcBuffer.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/buffer/class-use -->
                              <Directory Id="doc_en_jp_go_aist_rtm_RTC_buffer_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocenJpGoAistRtmRtcBufferClassuse" 
                                           Guid="{% RtmSourceJavadocenJpGoAistRtmRtcBufferClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcBufferClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocenJpGoAistRtmRtcBufferClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/class-use -->
                            <Directory Id="doc_en_jp_go_aist_rtm_RTC_classuse" Name="class-use">
                              <Component Id="RtmSourceJavadocenJpGoAistRtmRtcClassuse" 
                                         Guid="{% RtmSourceJavadocenJpGoAistRtmRtcClassuse.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcClassuse_f' On='uninstall' />
                                {% for file in RtmSourceJavadocenJpGoAistRtmRtcClassuse.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>
                            </Directory>

                            <!-- rtm/RTC/executionContext -->
                            <Directory Id="doc_en_jp_go_aist_rtm_RTC_executionContext" Name="executionContext">
                              <Component Id="RtmSourceJavadocenJpGoAistRtmRtcExecutioncontext" 
                                         Guid="{% RtmSourceJavadocenJpGoAistRtmRtcExecutioncontext.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcExecutioncontext_f' On='uninstall' />
                                {% for file in RtmSourceJavadocenJpGoAistRtmRtcExecutioncontext.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/executionContext/class-use -->
                              <Directory Id="doc_en_jp_go_aist_rtm_RTC_executionContext_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocenJpGoAistRtmRtcExecutioncontextClassuse" 
                                           Guid="{% RtmSourceJavadocenJpGoAistRtmRtcExecutioncontextClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcExecutioncontextClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocenJpGoAistRtmRtcExecutioncontextClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/log -->
                            <Directory Id="doc_en_jp_go_aist_rtm_RTC_log" Name="log">
                              <Component Id="RtmSourceJavadocenJpGoAistRtmRtcLog" 
                                         Guid="{% RtmSourceJavadocenJpGoAistRtmRtcLog.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcLog_f' On='uninstall' />
                                {% for file in RtmSourceJavadocenJpGoAistRtmRtcLog.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/log/class-use -->
                              <Directory Id="doc_en_jp_go_aist_rtm_RTC_log_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocenJpGoAistRtmRtcLogClassuse" 
                                           Guid="{% RtmSourceJavadocenJpGoAistRtmRtcLogClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcLogClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocenJpGoAistRtmRtcLogClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/port -->
                            <Directory Id="doc_en_jp_go_aist_rtm_RTC_port" Name="port">
                              <Component Id="RtmSourceJavadocenJpGoAistRtmRtcPort" 
                                         Guid="{% RtmSourceJavadocenJpGoAistRtmRtcPort.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcPort_f' On='uninstall' />
                                {% for file in RtmSourceJavadocenJpGoAistRtmRtcPort.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/port/class-use -->
                              <Directory Id="doc_en_jp_go_aist_rtm_RTC_port_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocenJpGoAistRtmRtcPortClassuse" 
                                           Guid="{% RtmSourceJavadocenJpGoAistRtmRtcPortClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcPortClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocenJpGoAistRtmRtcPortClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>

                              <!-- rtm/RTC/port/publisher -->
                              <Directory Id="doc_en_jp_go_aist_rtm_RTC_port_publisher" Name="publisher">
                                <Component Id="RtmSourceJavadocenJpGoAistRtmRtcPortPublisher" 
                                           Guid="{% RtmSourceJavadocenJpGoAistRtmRtcPortPublisher.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcPortPublisher_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocenJpGoAistRtmRtcPortPublisher.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>

                                <!-- rtm/RTC/port/publisher/class-use -->
                                <Directory Id="doc_en_jp_go_aist_rtm_RTC_port_publisher_classuse" Name="class-use">
                                  <Component Id="RtmSourceJavadocenJpGoAistRtmRtcPortPublisherClassuse" 
                                             Guid="{% RtmSourceJavadocenJpGoAistRtmRtcPortPublisherClassuse.GUID %}">
                                    <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcPortPublisherClassuse_f' On='uninstall' />
                                    {% for file in RtmSourceJavadocenJpGoAistRtmRtcPortPublisherClassuse.Files %}
                                    <File Id="{% file.Id %}"
                                          Name="{% file.Name %}" DiskId="1"
                                          Source="{% file.Source %}">
                                    </File>
                                    {% endfor %}
                                  </Component>
                                </Directory>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/SDOPackage -->
                            <Directory Id="doc_en_jp_go_aist_rtm_RTC_SDOPackage" Name="SDOPackage">
                              <Component Id="RtmSourceJavadocenJpGoAistRtmRtcSdopackage" 
                                         Guid="{% RtmSourceJavadocenJpGoAistRtmRtcSdopackage.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcSdopackage_f' On='uninstall' />
                                {% for file in RtmSourceJavadocenJpGoAistRtmRtcSdopackage.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/SDOPackage/class-use -->
                              <Directory Id="doc_en_jp_go_aist_rtm_RTC_SDOPackage_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocenJpGoAistRtmRtcSdopackageClassuse" 
                                           Guid="{% RtmSourceJavadocenJpGoAistRtmRtcSdopackageClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcSdopackageClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocenJpGoAistRtmRtcSdopackageClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>

                            <!-- rtm/RTC/util -->
                            <Directory Id="doc_en_jp_go_aist_rtm_RTC_util" Name="util">
                              <Component Id="RtmSourceJavadocenJpGoAistRtmRtcUtil" 
                                         Guid="{% RtmSourceJavadocenJpGoAistRtmRtcUtil.GUID %}">
                                <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcUtil_f' On='uninstall' />
                                {% for file in RtmSourceJavadocenJpGoAistRtmRtcUtil.Files %}
                                <File Id="{% file.Id %}"
                                      Name="{% file.Name %}" DiskId="1"
                                      Source="{% file.Source %}">
                                </File>
                                {% endfor %}
                              </Component>

                              <!-- rtm/RTC/util/class-use -->
                              <Directory Id="doc_en_jp_go_aist_rtm_RTC_util_classuse" Name="class-use">
                                <Component Id="RtmSourceJavadocenJpGoAistRtmRtcUtilClassuse" 
                                           Guid="{% RtmSourceJavadocenJpGoAistRtmRtcUtilClassuse.GUID %}">
                                  <RemoveFolder Id='RtmSourceJavadocenJpGoAistRtmRtcUtilClassuse_f' On='uninstall' />
                                  {% for file in RtmSourceJavadocenJpGoAistRtmRtcUtilClassuse.Files %}
                                  <File Id="{% file.Id %}"
                                        Name="{% file.Name %}" DiskId="1"
                                        Source="{% file.Source %}">
                                  </File>
                                  {% endfor %}
                                </Component>
                              </Directory>
                            </Directory>
                          </Directory>
                        </Directory>
                      </Directory>
                    </Directory>
                  </Directory>

                  <!-- OpenRTM -->
                  <Directory Id="doc_en_OpenRTM" Name="OpenRTM">
                    <Component Id="RtmSourceJavadocenOpenrtm" 
                               Guid="{% RtmSourceJavadocenOpenrtm.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocenOpenrtm_f' On='uninstall' />
                      {% for file in RtmSourceJavadocenOpenrtm.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- OpenRTM/class-use -->
                    <Directory Id="doc_en_OpenRTM_classuse" Name="class-use">
                      <Component Id="RtmSourceJavadocenOpenrtmClassuse" 
                                 Guid="{% RtmSourceJavadocenOpenrtmClassuse.GUID %}">
                        <RemoveFolder Id='RtmSourceJavadocenOpenrtmClassuse_f' On='uninstall' />
                        {% for file in RtmSourceJavadocenOpenrtmClassuse.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>

                  <!-- resources -->
                  <Directory Id="doc_en_resources" Name="resources">
                    <Component Id="RtmSourceJavadocenResources" 
                               Guid="{% RtmSourceJavadocenResources.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocenResources_f' On='uninstall' />
                      {% for file in RtmSourceJavadocenResources.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>
                  </Directory>

                  <!-- RTC -->
                  <Directory Id="doc_en_RTC" Name="RTC">
                    <Component Id="RtmSourceJavadocenRtc" 
                               Guid="{% RtmSourceJavadocenRtc.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocenRtc_f' On='uninstall' />
                      {% for file in RtmSourceJavadocenRtc.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- RTC/class-use -->
                    <Directory Id="doc_en_RTC_classuse" Name="class-use">
                      <Component Id="RtmSourceJavadocenRtcClassuse" 
                                 Guid="{% RtmSourceJavadocenRtcClassuse.GUID %}">
                        <RemoveFolder Id='RtmSourceJavadocenRtcClassuse_f' On='uninstall' />
                        {% for file in RtmSourceJavadocenRtcClassuse.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>

                  <!-- RTM -->
                  <Directory Id="doc_en_RTM" Name="RTM">
                    <Component Id="RtmSourceJavadocenRtm" 
                               Guid="{% RtmSourceJavadocenRtm.GUID %}">
                      <RemoveFolder Id='RtmSourceJavadocenRtm_f' On='uninstall' />
                      {% for file in RtmSourceJavadocenRtm.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- RTM/class-use -->
                    <Directory Id="doc_en_RTM_classuse" Name="class-use">
                      <Component Id="RtmSourceJavadocenRtmClassuse" 
                                 Guid="{% RtmSourceJavadocenRtmClassuse.GUID %}">
                        <RemoveFolder Id='RtmSourceJavadocenRtmClassuse_f' On='uninstall' />
                        {% for file in RtmSourceJavadocenRtmClassuse.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>
                </Directory>
              </Directory>
            </Directory>
            <!-- end of doc -->

            <!-- examples -->
            <Directory Id="examples" Name="examples">

              <!-- Java -->
              <Directory Id="JavaExamples" Name="Java">

                <!-- Bat files -->
                <Component Id="RtmSourceExamplesBat" 
                           Guid="{% RtmSourceExamplesBat.GUID %}">
                  <RemoveFile Id='RtmSourceExamplesBat' On='uninstall' Name='*.log' />
                  <RemoveFolder Id='RtmSourceExamplesBat_f' On='uninstall' />
                  {% for file in RtmSourceExamplesBat.Files %}
                    <File Id="{% file.Id %}"
                         Name="{% file.Name %}" DiskId="1"
                         Source="{% file.Source %}">
                      <Shortcut Id="{% file.Id %}" Directory="ExpMenuFolder"
                                Name="{% file.Name %}"
                                Show="normal" WorkingDirectory="JavaExamples"/>
                    </File>
                  {% endfor %}
                </Component>

                <!-- RTMExamples -->
                <Directory Id="JavaExamplesRTMExamples" Name="RTMExamples">

                  <!-- Composite -->
                  <Directory Id="Composite" Name="Composite">
                    <Component Id="RtmSourceExamplesRtmexamplesComposite" 
                               Guid="{% RtmSourceExamplesRtmexamplesComposite.GUID %}">
                      <RemoveFolder Id='RtmSourceExamplesRtmexamplesComposite_f' On='uninstall' />
                      {% for file in RtmSourceExamplesRtmexamplesComposite.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>
                  </Directory>

                  <!-- ConfigSample -->
                  <Directory Id="ConfigSample" Name="ConfigSample">
                    <Component Id="RtmSourceExamplesRtmexamplesConfigsample" 
                               Guid="{% RtmSourceExamplesRtmexamplesConfigsample.GUID %}">
                      <RemoveFolder Id='RtmSourceExamplesRtmexamplesConfigsample_f' On='uninstall' />
                      {% for file in RtmSourceExamplesRtmexamplesConfigsample.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>
                  </Directory>

                  <!-- GUIIn -->
                  <Directory Id="GUIIn" Name="GUIIn">
                    <Component Id="RtmSourceExamplesRtmexamplesGuiin" 
                               Guid="{% RtmSourceExamplesRtmexamplesGuiin.GUID %}">
                      <RemoveFolder Id='RtmSourceExamplesRtmexamplesGuiin_f' On='uninstall' />
                      {% for file in RtmSourceExamplesRtmexamplesGuiin.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- GUIIn/control -->
                    <Directory Id="GUIIn_control" Name="control">
                      <Component Id="RtmSourceExamplesRtmexamplesGuiinControl" 
                                 Guid="{% RtmSourceExamplesRtmexamplesGuiinControl.GUID %}">
                        <RemoveFolder Id='RtmSourceExamplesRtmexamplesGuiinControl_f' On='uninstall' />
                        {% for file in RtmSourceExamplesRtmexamplesGuiinControl.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>

                    <!-- GUIIn/model -->
                    <Directory Id="GUIIn_model" Name="model">
                      <Component Id="RtmSourceExamplesRtmexamplesGuiinModel" 
                                 Guid="{% RtmSourceExamplesRtmexamplesGuiinModel.GUID %}">
                        <RemoveFolder Id='RtmSourceExamplesRtmexamplesGuiinModel_f' On='uninstall' />
                        {% for file in RtmSourceExamplesRtmexamplesGuiinModel.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>

                    <!-- GUIIn/view -->
                    <Directory Id="GUIIn_view" Name="view">
                      <Component Id="RtmSourceExamplesRtmexamplesGuiinView" 
                                 Guid="{% RtmSourceExamplesRtmexamplesGuiinView.GUID %}">
                        <RemoveFolder Id='RtmSourceExamplesRtmexamplesGuiinView_f' On='uninstall' />
                        {% for file in RtmSourceExamplesRtmexamplesGuiinView.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>

                  <!-- SeqIO -->
                  <Directory Id="SeqIO" Name="SeqIO">
                    <Component Id="RtmSourceExamplesRtmexamplesSeqio" 
                               Guid="{% RtmSourceExamplesRtmexamplesSeqio.GUID %}">
                      <RemoveFolder Id='RtmSourceExamplesRtmexamplesSeqio_f' On='uninstall' />
                      {% for file in RtmSourceExamplesRtmexamplesSeqio.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>

                    <!-- SeqIO/view -->
                    <Directory Id="SeqIO_view" Name="view">
                      <Component Id="RtmSourceExamplesRtmexamplesSeqioView" 
                                 Guid="{% RtmSourceExamplesRtmexamplesSeqioView.GUID %}">
                        <RemoveFolder Id='RtmSourceExamplesRtmexamplesSeqioView_f' On='uninstall' />
                        {% for file in RtmSourceExamplesRtmexamplesSeqioView.Files %}
                        <File Id="{% file.Id %}"
                              Name="{% file.Name %}" DiskId="1"
                              Source="{% file.Source %}">
                        </File>
                        {% endfor %}
                      </Component>
                    </Directory>
                  </Directory>

                  <!-- SimpleIO -->
                  <Directory Id="SimpleIO" Name="SimpleIO">
                    <Component Id="RtmSourceExamplesRtmexamplesSimpleio" 
                               Guid="{% RtmSourceExamplesRtmexamplesSimpleio.GUID %}">
                      <RemoveFolder Id='RtmSourceExamplesRtmexamplesSimpleio_f' On='uninstall' />
                      {% for file in RtmSourceExamplesRtmexamplesSimpleio.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>
                  </Directory>

                  <!-- SimpleService -->
                  <Directory Id="SimpleService" Name="SimpleService">
                    <Component Id="RtmSourceExamplesRtmexamplesSimpleservice" 
                               Guid="{% RtmSourceExamplesRtmexamplesSimpleservice.GUID %}">
                      <RemoveFolder Id='RtmSourceExamplesRtmexamplesSimpleservice_f' On='uninstall' />
                      {% for file in RtmSourceExamplesRtmexamplesSimpleservice.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>
                  </Directory>

                  <!-- SinCosOut -->
                  <Directory Id="SinCosOut" Name="SinCosOut">
                    <Component Id="RtmSourceExamplesRtmexamplesSincosout" 
                               Guid="{% RtmSourceExamplesRtmexamplesSincosout.GUID %}">
                      <RemoveFolder Id='RtmSourceExamplesRtmexamplesSincosout_f' On='uninstall' />
                      {% for file in RtmSourceExamplesRtmexamplesSincosout.Files %}
                      <File Id="{% file.Id %}"
                            Name="{% file.Name %}" DiskId="1"
                            Source="{% file.Source %}">
                      </File>
                      {% endfor %}
                    </Component>
                  </Directory>

                <!-- end of RTMExamples -->
                </Directory>

              <!-- end of Java -->
              </Directory>

            <!-- end of examples -->
            </Directory>
            <!-- rtmtools components -->
            <?if $(env.INCLUDE_OPENRTP) = YES ?>
            <?include OpenRTP_inc.wxs ?>
            <?endif ?>
            <!-- end of rtmtools -->

          </Directory>
	        
      </Directory>
        
      <!-- rtmtools components -->
<!--
        <?if $(env.INCLUDE_OPENRTP) = YES ?>
        <?include OpenRTP_inc.wxs ?>
	<?endif ?>
-->
        <!-- end of rtmtools -->
      <!-- end of Program Files Folder -->
        
      </Directory>

      <!-- Program Folder -->
      <Directory Id="ProgramMenuFolder">
        <Directory Id="AppMenuFolder" Name="{% Product.Name %} {% Product.ShortVersion %}">
          <Directory Id="JavaMenuFolder" Name="Java">
            <Directory Id="ToolsMenuFolder" Name="tools">
            </Directory>
            <Directory Id="Components" Name="components">
              <Directory Id="ExpMenuFolder" Name="examples">
              </Directory>
            </Directory>
            <Directory Id="DocMenuFolder" Name="documents">
            </Directory>
          </Directory>
        </Directory>
      </Directory>

    <!-- end of SourceDir -->
    </Directory>

    <!-- Difinition of OpenRTM-aist -->
    <Feature Id="ProductFeature" Level="1" Title="OpenRTM-aist (Java)"
             ConfigurableDirectory="INSTALLLOCATION">

      <!-- runtime -->
      <Feature Id="Rtm_Runtime" Level="1" Title="Runtime Environment">
        <ComponentRef Id="ENV1"/>
        <ComponentRef Id="ENV2"/>
        <ComponentRef Id="RtmSourceExamplesBin"/>
        <ComponentRef Id="RtmSourceJar"/>
      </Feature>

      <!-- idl -->
      <Feature Id="Rtm_Idl" Level="1" Title="Idl">
        <ComponentRef Id="RtmSourceRtm_javaIdl"/>
        <ComponentRef Id="RtmSourceRtm_javaIdlDevice_interfaces"/>
      </Feature>
      <!-- documents -->
      <Feature Id="Rtm_Docs" Level="1" Title="Documents">
        <ComponentRef Id="RtmSourceJavadoc"/>
        <ComponentRef Id="RtmSourceJavadoc_sdopackage"/>
        <ComponentRef Id="RtmSourceJavadoc_sdopackageClassuse"/>
        <ComponentRef Id="RtmSourceJavadocIndexfiles"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtm"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmClassuse"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtc"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcBuffer"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcBufferClassuse"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcClassuse"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcExecutioncontext"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcExecutioncontextClassuse"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcLog"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcLogClassuse"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcPort"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcPortClassuse"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcPortPublisher"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcPortPublisherClassuse"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcSdopackage"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcSdopackageClassuse"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcUtil"/>
        <ComponentRef Id="RtmSourceJavadocJpGoAistRtmRtcUtilClassuse"/>
        <ComponentRef Id="RtmSourceJavadocOpenrtm"/>
        <ComponentRef Id="RtmSourceJavadocOpenrtmClassuse"/>
        <ComponentRef Id="RtmSourceJavadocResources"/>
        <ComponentRef Id="RtmSourceJavadocRtc"/>
        <ComponentRef Id="RtmSourceJavadocRtcClassuse"/>
        <ComponentRef Id="RtmSourceJavadocRtm"/>
        <ComponentRef Id="RtmSourceJavadocRtmClassuse"/>
        <ComponentRef Id="RtmSourceJavadocen"/>
        <ComponentRef Id="RtmSourceJavadocen_sdopackage"/>
        <ComponentRef Id="RtmSourceJavadocen_sdopackageClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenIndexfiles"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtm"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtc"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcBuffer"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcBufferClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcExecutioncontext"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcExecutioncontextClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcLog"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcLogClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcPort"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcPortClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcPortPublisher"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcPortPublisherClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcSdopackage"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcSdopackageClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcUtil"/>
        <ComponentRef Id="RtmSourceJavadocenJpGoAistRtmRtcUtilClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenOpenrtm"/>
        <ComponentRef Id="RtmSourceJavadocenOpenrtmClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenResources"/>
        <ComponentRef Id="RtmSourceJavadocenRtc"/>
        <ComponentRef Id="RtmSourceJavadocenRtcClassuse"/>
        <ComponentRef Id="RtmSourceJavadocenRtm"/>
        <ComponentRef Id="RtmSourceJavadocenRtmClassuse"/>
      </Feature>

      <!-- examples -->
      <Feature Id="Rtm_Examples" Level="1" Title="Examples">
        <ComponentRef Id="RtmSourceExamplesBat"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesComposite"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesConfigsample"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesGuiin"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesGuiinControl"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesGuiinModel"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesGuiinView"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesSeqio"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesSeqioView"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesSimpleio"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesSimpleservice"/>
        <ComponentRef Id="RtmSourceExamplesRtmexamplesSincosout"/>
      </Feature>
    
    </Feature>

    <!-- OpenRTP tools -->
    <?if $(env.INCLUDE_OPENRTP) = YES ?>
    <Feature Id="OpenRTP" Level="1" Title="OpenRT Platform Tool Chain">
      <!--
      <Condition Level ="1"><![CDATA[ (FILEEXISTS =  "") ]]></Condition>
      <Condition Level ="0"><![CDATA[ (FILEEXISTS <> "") ]]></Condition>
      -->
      <!-- rtse rcp -->
      <Feature Id="RTSystemEditor" Level="1" Title="RTSystemEditor">
	<ComponentRef Id="Openrtp" />
	<ComponentRef Id="OpenrtpConfiguration" />
	<ComponentRef Id="OpenrtpPlugins" />
	<ComponentRef Id="org.eclipse.core.runtime.compatibility.registry_3.2.200.v20080610" />
	<ComponentRef Id="META_INF" />
	<ComponentRef Id="org.eclipse.equinox.launcher.win32.win32.x86_1.0.101.R34x_v20080731" />
	<ComponentRef Id="META_INF_2" />
      </Feature>
    </Feature>
    <?endif ?>
    
    <WixVariable Id="WixUILicenseRtf" Value="License.rtf" />
    <WixVariable Id="WixUIBannerBmp" Value="Bitmaps/bannrbmp.bmp" />
    <WixVariable Id="WixUIDialogBmp" Value="Bitmaps/dlgbmp.bmp" />

    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLLOCATION" />

    <!-- WixUI_Mondo -->
    <UIRef Id="WixUI_Mondo_RTM" />

  </Product>
</Wix>
